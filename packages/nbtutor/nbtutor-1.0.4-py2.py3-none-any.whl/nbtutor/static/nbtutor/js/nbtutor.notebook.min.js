(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.nbtutorNotebook = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function toShortString(e,t){t=""+t||"unknown";var n={int:t.length>3?"INT":t,float:t.length>3?"FLT":t,str:t.length>3?"STR":t,bool:t[0].toUpperCase(),none:"NON",complex:"CPX",module:"MOD",function:"FNC",lambda:"FNC",class:"CLS",list:"LST",tuple:"TPL"};return n[e]||"OBJ"}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),FrameTimeline=exports.FrameTimeline=function(){function e(t,n,a){_classCallCheck(this,e),this.startstep=t,this.tracestep=t,this.name=n.name,this.uuid=n.uuid,this.vars=[],this.push(n,a)}return _createClass(e,[{key:"_fill",value:function(){var e=this;this.vars.map(function(t){for(var n=t.values.length;n<e.tracestep;n++)t.values.push("")})}},{key:"removeEmptyVars",value:function(){var e=[];this.vars.map(function(t,n){t.values.every(function(e){return""===e})&&e.push(n)});var t=this;e.sort(function(e,t){return t-e}),e.map(function(e){t.vars.splice(e,1)})}},{key:"getVarByName",value:function(e){var t=this.vars.map(function(e){return e.name}).indexOf(e);return this.vars[t]}},{key:"push",value:function(e,t){if(e.uuid!=this.uuid)throw new Error("frame uuid mismatch!");var n=this;e.vars.map(function(e){var a=n.getVarByName(e.name);a||(a={name:e.name,values:[]},n.vars.push(a),n._fill());var r=t.map(function(e){return e.id}).indexOf(e.id),i=t[r],s=toShortString(i.type,i.value);a.values.push(s)}),this.tracestep+=1,this._fill()}},{key:"pop",value:function(){var e=this.vars.map(function(e){return{name:e.name}}),t=this;return e.map(function(e){var n=t.getVarByName(e.name);e.value=n.values.pop()}),this.removeEmptyVars(),this.tracestep>0&&(this.tracestep-=1),e}},{key:"isEmpty",value:function(){return 0===this.vars.length}}]),e}();

},{}],2:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.HeapHistory=void 0;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),_nbtutorDeps=require("nbtutor-deps"),HeapHistory=exports.HeapHistory=function(){function e(t){_classCallCheck(this,e),this.data=t||[],this._setUUids()}return _createClass(e,[{key:"_setUUids",value:function(){var e=this,t=[];this.data.map(function(e){e.map(function(e){t.indexOf(e.id)<0&&t.push(e.id)})}),t.map(function(t){var n="h-"+_nbtutorDeps.uuid.v4();e.data.map(function(e){e.map(function(e){e.id===t&&(e.uuid=n)})})})}},{key:"getHeapObjects",value:function(e){return this.data[e]}},{key:"getObjectById",value:function(e,t){var n=this.getHeapObjects(e)||[],a=n.map(function(e){return e.id}).indexOf(t);return n[a]}}]),e}();

},{"nbtutor-deps":"nbtutor-deps"}],3:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),OutputHistory=exports.OutputHistory=function(){function t(e){_classCallCheck(this,t),this.data=e}return _createClass(t,[{key:"getOutput",value:function(t){return this.data[t]}}]),t}();

},{}],4:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.StackHistory=void 0;var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),_nbtutorDeps=require("nbtutor-deps"),StackHistory=exports.StackHistory=function(){function t(e){_classCallCheck(this,t),this.data=e||[],this._setUUids()}return _createClass(t,[{key:"_setUUids",value:function(){var t=this,e=[];this.data.map(function(t){t.map(function(t){e.indexOf(t.id)<0&&e.push(t.id)})}),e.map(function(e){var n="f-"+_nbtutorDeps.uuid.v4();t.data.map(function(t){t.map(function(t){t.id===e&&(t.uuid=n)})})}),this.data.map(function(t){t.map(function(t){t.vars.map(function(t){t.uuid="v-"+_nbtutorDeps.uuid.v4()})})})}},{key:"getStackFrames",value:function(t){return this.data[t]}},{key:"getFrameById",value:function(t,e){var n=this.getStackFrames(t)||[],a=n.map(function(t){return t.id}).indexOf(e);return n[a]}},{key:"getFrameVarByName",value:function(t,e,n){var a=this.getFrameById(t,e)||[],r=a.vars||[],i=a.vars.map(function(t){return t.name}).indexOf(n);return r[i]}},{key:"getFrameVarById",value:function(t,e,n){var a=this.getFrameById(t,e)||[],r=a.vars||[],i=a.vars.map(function(t){return t.id}).indexOf(n);return r[i]}}]),t}();

},{"nbtutor-deps":"nbtutor-deps"}],5:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.StackTimeline=void 0;var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),_frame_timeline=require("./frame_timeline"),StackTimeline=exports.StackTimeline=function(){function e(){_classCallCheck(this,e),this.tracestep=0,this.stack_frames=[]}return _createClass(e,[{key:"_fill",value:function(){var e=this;this.stack_frames.map(function(t){t.tracestep=e.tracestep,t._fill()})}},{key:"clear",value:function(){this.tracestep=0,this.stack_frames=[]}},{key:"removeEmptyFrames",value:function(){var e=[];this.stack_frames.map(function(t,a){t.isEmpty()&&e.push(a)});var t=this;e.sort(function(e,t){return t-e}),e.map(function(e){t.stack_frames.splice(e,1)})}},{key:"push",value:function(e,t){var a=this;e.map(function(e){for(var s=!1,r=0;r<a.stack_frames.length;r++)a.stack_frames[r].uuid===e.uuid&&(a.stack_frames[r].push(e,t),s=!0);s||a.stack_frames.push(new _frame_timeline.FrameTimeline(a.tracestep,e,t))}),this.tracestep+=1,this._fill()}},{key:"pop",value:function(){var e=[];return this.tracestep>0&&(this.stack_frames.map(function(t){e.push({frame:t.name,uuid:t.uuid,vars:t.pop()})}),this.tracestep-=1,this.removeEmptyFrames()),e}}]),e}();

},{"./frame_timeline":1}],6:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.TraceHistory=void 0;var _createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,s,r){return s&&t(e.prototype,s),r&&t(e,r),e}}(),_nbtutorDeps=require("nbtutor-deps"),_stack_history=require("./stack_history"),_heap_history=require("./heap_history"),_output_history=require("./output_history"),TraceHistory=exports.TraceHistory=function(){function t(e){_classCallCheck(this,t),this.cell=e,this.tracesteps=0,this.stack_history=null,this.heap_history=null,this.output_history=null}return _createClass(t,[{key:"clear",value:function(){this.tracesteps=0,this.stack_history=null,this.heap_history=null,this.output_history=null}},{key:"getLineNumbers",value:function(t){var e=this.stack_history.getStackFrames(t)||[],s=this.stack_history.getStackFrames(t-1)||[],r=s[s.length-1]||{},i=[+(r.lineno||0)],o=e.map(function(t){return+t.lineno}),n=o.pop();if("return"===r.event){var a=s[s.length-2]||{};i.push(+(a.lineno||0))}return t==this.stack_history.data.length-1&&(n=0),{prevLines:i,curLines:o,nextLine:n}}},{key:"updateData",value:function(t){this.stack_history=new _stack_history.StackHistory(t.stack_history),this.heap_history=new _heap_history.HeapHistory(t.heap_history),this.output_history=new _output_history.OutputHistory(t.output_history),this.tracesteps=t.stack_history.length}}]),t}();

},{"./heap_history":2,"./output_history":3,"./stack_history":4,"nbtutor-deps":"nbtutor-deps"}],7:[function(require,module,exports){
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.GutterMarkers=void 0;var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),_nbtutorDeps=require("nbtutor-deps"),GutterMarkers=exports.GutterMarkers=function(){function e(r){_classCallCheck(this,e),this.codemirror=r.code_mirror,this.codemirror.setOption("lineNumbers",!0),this.$root=r.element.find(".inner_cell"),this.$legend=(0,_nbtutorDeps.$)("<div/>").addClass("nbtutor-hidden").addClass("nbtutor-legend");var t=this.codemirror.options.gutters;t.indexOf("nbtutor-linemarkers")<0&&t.push("nbtutor-linemarkers"),this._build_legend()}return _createClass(e,[{key:"_build_legend",value:function(){var e=(0,_nbtutorDeps.$)("<i/>").attr("class","fa fa-long-arrow-right fa-lg").addClass("nbtutor-prev-line"),r=(0,_nbtutorDeps.$)("<i/>").attr("class","fa fa-long-arrow-right fa-lg").addClass("nbtutor-current-line"),t=(0,_nbtutorDeps.$)("<i/>").attr("class","fa fa-long-arrow-right fa-lg").addClass("nbtutor-next-line");this.$legend.append((0,_nbtutorDeps.$)("<p/>").append(e).append((0,_nbtutorDeps.$)("<span/>").text("Previous line"))),this.$legend.append((0,_nbtutorDeps.$)("<p/>").append(t).append((0,_nbtutorDeps.$)("<span/>").text("Next line"))),this.$legend.append((0,_nbtutorDeps.$)("<p/>").append(r).append((0,_nbtutorDeps.$)("<span/>").text("Waiting for next frame"))),this.$root.append(this.$legend)}},{key:"setMarkers",value:function(e){this.codemirror.clearGutter("nbtutor-linemarkers");var r=e.prevLines,t=e.curLines,n=e.nextLine,a=this;t.map(function(e){var r=(0,_nbtutorDeps.$)("<i/>").attr("class","fa fa-long-arrow-right fa-lg").addClass("nbtutor-current-line");e-1>=0&&a.codemirror.setGutterMarker(e-1,"nbtutor-linemarkers",r.toArray()[0])}),r.map(function(e){var r=(0,_nbtutorDeps.$)("<i/>").attr("class","fa fa-long-arrow-right fa-lg").addClass("nbtutor-prev-line");e-1>=0&&a.codemirror.setGutterMarker(e-1,"nbtutor-linemarkers",r.toArray()[0])});var s=(0,_nbtutorDeps.$)("<i/>").attr("class","fa fa-long-arrow-right fa-lg").addClass("nbtutor-next-line");n-1>=0&&this.codemirror.setGutterMarker(n-1,"nbtutor-linemarkers",s.toArray()[0])}},{key:"showLegend",value:function(){this.$legend.removeClass("nbtutor-hidden")}},{key:"hideLegend",value:function(){this.$legend.addClass("nbtutor-hidden")}},{key:"clearMarkers",value:function(){this.codemirror.clearGutter("nbtutor-linemarkers")}},{key:"destroy",value:function(){this.clearMarkers(),this.$legend.remove()}}]),e}();

},{"nbtutor-deps":"nbtutor-deps"}],8:[function(require,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function alertUserMissingData(){var t=(0,_nbtutorDeps.$)("<p/>").text("No visualization data was found for this cell. Please include the following magic at the start of the cell and run the code again:").append((0,_nbtutorDeps.$)("<pre/>").text("%%nbtutor"));_dialog2.default.modal({notebook:_namespace2.default.notebook,keyboard_manager:_namespace2.default.notebook.keyboard_manager,title:"Missing Visualization Data",body:t,buttons:{OK:{}}})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.VisualizedCell=void 0;var _createClass=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),_nbtutorDeps=require("nbtutor-deps"),_toolbar=require("./toolbar"),_gutters=require("./gutters"),_trace_history=require("../data/trace_history"),_stack_timeline=require("../data/stack_timeline"),_html_memory=require("../render/html_memory"),_html_timeline=require("../render/html_timeline"),_dialog=require("base/js/dialog"),_dialog2=_interopRequireDefault(_dialog),_events=require("base/js/events"),_events2=_interopRequireDefault(_events),_namespace=require("base/js/namespace"),_namespace2=_interopRequireDefault(_namespace),VisualizedCell=exports.VisualizedCell=function(){function t(e){_classCallCheck(this,t),this.tracestep=0,this.trace_history=new _trace_history.TraceHistory(e),this.stack_timeline=new _stack_timeline.StackTimeline,this.cell=e,this.codemirror=e.code_mirror,this.output_area=this.cell.output_area,this.$input_area=e.element.find(".input_area").addClass("nbtutor-input-area"),this.$nbtutor_canvas=(0,_nbtutorDeps.$)("<div/>").attr("class","nbtutor-canvas").attr("id","c-"+_nbtutorDeps.uuid.v4()).addClass("nbtutor-hidden"),this.d3Root=_nbtutorDeps.d3.select(this.$nbtutor_canvas.toArray()[0]),this.toolbar=new _toolbar.Toolbar(e),this.markers=new _gutters.GutterMarkers(e),this.memoryUI=new _html_memory.MemoryModelUI(this.trace_history,this.d3Root),this.timelineUI=new _html_timeline.TimelineUI(this.stack_timeline,this.d3Root),this._build()}return _createClass(t,[{key:"_checkData",value:function(){this.trace_history&&this.trace_history.stack_history||(this.toolbar.$select_view.val("none").trigger("change"),alertUserMissingData())}},{key:"_bindButtons",value:function(){var t=this,e=this;this.toolbar.$btn_first.on("click",function(){var a=t.trace_history.stack_history,r=t.trace_history.heap_history;e._checkData(),e.tracestep=0,e.stack_timeline.clear(),e.stack_timeline.push(a.getStackFrames(e.tracestep),r.getHeapObjects(e.tracestep)),e.visualize()}),this.toolbar.$btn_prev.on("click",function(){e.tracestep>0&&(e._checkData(),e.tracestep-=1,e.stack_timeline.pop(),e.visualize())}),this.toolbar.$btn_next.on("click",function(){if(e.tracestep<e.trace_history.tracesteps-1){var a=t.trace_history.stack_history,r=t.trace_history.heap_history;e._checkData(),e.tracestep+=1,e.stack_timeline.push(a.getStackFrames(e.tracestep),r.getHeapObjects(e.tracestep)),e.visualize()}}),this.toolbar.$btn_last.on("click",function(){var a=t.trace_history.stack_history,r=t.trace_history.heap_history;e._checkData(),e.stack_timeline.clear(),e.tracestep=e.trace_history.tracesteps-1;for(var i=0;i<e.tracestep+1;i++)e.stack_timeline.push(a.getStackFrames(i),r.getHeapObjects(i));e.visualize()})}},{key:"_build",value:function(){this._bindButtons(),this.$input_area.append(this.$nbtutor_canvas);var t=this;_events2.default.on("global_hide.CellToolBar",function(){t.destroy()}),this.toolbar.$select_view.on("change",function(){t.memoryUI.destroy();var e=(0,_nbtutorDeps.$)(this).val();"none"==e?(t.markers.clearMarkers(),t.markers.hideLegend(),t.$nbtutor_canvas.addClass("nbtutor-hidden")):(t.markers.showLegend(),t.$nbtutor_canvas.removeClass("nbtutor-hidden"),t.toolbar.$btn_first.trigger("click"))}),this.codemirror.on("change",function(){t.markers.clearMarkers(),t.toolbar.$select_view.val("none").trigger("change"),t.trace_history.clear()})}},{key:"visualize",value:function(){var t=this.toolbar.$select_view.val();"memory"==t&&this.memoryUI.create(this.tracestep),"timeline"==t&&this.timelineUI.create();var e=this.trace_history.getLineNumbers(this.tracestep);this.markers.setMarkers(e);var a=this.trace_history.output_history;this.output_area.clear_output(),this.output_area.handle_output({header:{msg_type:"stream"},content:{name:"nbtutor",text:a.getOutput(this.tracestep)}})}},{key:"updateData",value:function(t){this.output_area.clear_output(),this.trace_history.updateData(t),this.toolbar.$select_view.val("memory").trigger("change")}},{key:"destroy",value:function(){this.$nbtutor_canvas.remove(),this.markers.destroy(),this.toolbar.destroy(),this.cell.nbtutor=null}}]),t}();

},{"../data/stack_timeline":5,"../data/trace_history":6,"../render/html_memory":10,"../render/html_timeline":11,"./gutters":7,"./toolbar":9,"base/js/dialog":"base/js/dialog","base/js/events":"base/js/events","base/js/namespace":"base/js/namespace","nbtutor-deps":"nbtutor-deps"}],9:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toolbar=void 0;var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_nbtutorDeps=require("nbtutor-deps"),Toolbar=exports.Toolbar=function(){function t(e){_classCallCheck(this,t),this.$root=e.celltoolbar.element.find(".button_container"),this.$btn_first=(0,_nbtutorDeps.$)("<button/>").text("<< First Line"),this.$btn_prev=(0,_nbtutorDeps.$)("<button/>").text("< Prev"),this.$btn_next=(0,_nbtutorDeps.$)("<button/>").text("Next >"),this.$btn_last=(0,_nbtutorDeps.$)("<button/>").text("Last Line >>"),this.$select_view=(0,_nbtutorDeps.$)("<select/>"),this._build()}return _createClass(t,[{key:"_build",value:function(){var t=this;this.$root.hasClass("nbtutor-buttons")&&this.destroy(),this.$root.addClass("nbtutor-buttons"),this.$root.append(this.$btn_first),this.$root.append(this.$btn_prev),this.$root.append(this.$btn_next),this.$root.append(this.$btn_last),this.$root.children("button").attr("type","button").addClass("nbtutor-hidden"),this.$root.append(this.$select_view),this.$select_view.append((0,_nbtutorDeps.$)("<option/>").attr("value","none").text("-")),this.$select_view.append((0,_nbtutorDeps.$)("<option/>").attr("value","memory").text("Memory")),this.$select_view.append((0,_nbtutorDeps.$)("<option/>").attr("value","timeline").text("Timeline"));this.$select_view.change(function(){var e=t.$select_view.val();"none"===e?t.hideButtons():t.showButtons()})}},{key:"showButtons",value:function(){this.$root.children("button").removeClass("nbtutor-hidden")}},{key:"hideButtons",value:function(){this.$root.children("button").addClass("nbtutor-hidden")}},{key:"destroy",value:function(){this.$root.empty()}}]),t}();

},{"nbtutor-deps":"nbtutor-deps"}],10:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.MemoryModelUI=void 0;var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,r,s){return r&&t(e.prototype,r),s&&t(e,s),e}}(),_nbtutorDeps=require("nbtutor-deps"),MemoryModelUI=exports.MemoryModelUI=function(){function t(e,r){_classCallCheck(this,t),this.trace_history=e,this.d3Root=r,this.connectors=[],this.objects_rendered=[],this.jsplumb=_nbtutorDeps.jsplumb.getInstance({Container:this.d3Root[0]})}return _createClass(t,[{key:"_setHover",value:function(t,e){_nbtutorDeps.d3.select(".nbtutor-var-object."+t).select(".nbtutor-var-value").classed("nbtutor-hover",e),_nbtutorDeps.d3.select(".nbtutor-var-object."+t).select("table").classed("nbtutor-hover",e),_nbtutorDeps.d3.selectAll("svg."+t).classed("jtk-hover",e),_nbtutorDeps.d3.selectAll("path."+t).classed("jtk-hover",e)}},{key:"_connectObjects",value:function(){var t=this;this.connectors.map(function(e){var r={paintStyle:{lineWidth:2,stroke:"#056"},endpoint:"Blank",anchors:["Right","Left"],connector:["Bezier",{curviness:80}],detachable:!1,overlays:[["Arrow",{length:10,width:10,location:1}]]};r.cssClass=e.from,r.overlays[0][1].cssClass=e.from,"r"==e.from[0]&&(r.anchors=["Top",["Left","Right"]]),_nbtutorDeps.d3.select("#"+e.to).classed(e.from,!0),t.jsplumb.connect({source:e.from,target:e.to},r)})}},{key:"_createHeapDiv",value:function(t){var e=t.options.position||"right",r=this.d3Root.select(".nbtutor-heap").append("div").attr("class","nbtutor-heap-row-"+e).append("div").attr("class","nbtutor-var-object").attr("id",t.uuid);return r}},{key:"_createPrimitive",value:function(t){var e=this._createHeapDiv(t);e.append("div").attr("class","nbtutor-var-type").text(t.type),e.append("div").attr("class","nbtutor-var-value").text(t.value)}},{key:"_createSequence",value:function(t,e){var r=this,s=this.trace_history.heap_history;t.values.map(function(a){var n=s.getObjectById(e,a.id);t.options.inline&&"primitive"==n.catagory||(a.uuid="r-"+_nbtutorDeps.uuid.v4(),r._createObject(n,e),r.connectors.push({from:a.uuid,to:n.uuid}))});var a=this._createHeapDiv(t);a.append("div").attr("class","nbtutor-var-type").text(t.type);for(var n=a.append("table").attr("class","nbtutor-seq-"+t.type),o=n.append("tr"),i=n.append("tr"),u=[],c=0;c<t.values.length;c++)u.push(c);var l=t.values.length-1;t.options.ellipsis&&("..."===t.values[l]?u[l]="...":(u.push("..."),t.values.push("..."))),o.selectAll("td").data(u).enter().append("td").attr("class","nbtutor-var-index").text(function(t){return t});var d=i.selectAll("td").data(t.values).enter().append("td").attr("class","nbtutor-anchor-from");d.append("div").each(function(r){if(t.options.ellipsis&&"..."===r)_nbtutorDeps.d3.select(this).text("...");else{var a=s.getObjectById(e,r.id);t.options.inline&&"primitive"===a.catagory?_nbtutorDeps.d3.select(this).text(a.value):_nbtutorDeps.d3.select(this).attr("id",function(t){return t.uuid})}}),d.on("mouseover",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!0),r._setHover(t.uuid,!0)}),d.on("mouseout",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!1),r._setHover(t.uuid,!1)})}},{key:"_createArray",value:function(t,e){var r=this._createHeapDiv(t);r.append("div").attr("class","nbtutor-var-type").text(t.type);for(var s=r.append("table").attr("class","nbtutor-seq-array"),a=s.append("tr"),n=s.append("tr"),o=[],i=0;i<t.values.length;i++)o.push(i);var u=t.values.length-1;t.options.ellipsis&&("..."===t.values[u]?o[u]="...":(o.push("..."),t.values.push("..."))),a.selectAll("td").data(o).enter().append("td").attr("class","nbtutor-var-index").text(function(t){return t}),n.selectAll("td").data(t.values).enter().append("td").attr("class","nbtutor-anchor-from").append("div").text(function(t){return t})}},{key:"_createKeyValue",value:function(t,e){var r=this,s=this.trace_history.heap_history;t.values.map(function(a){var n=s.getObjectById(e,a.key_id);t.options.inline_keys&&"primitive"==n.catagory||(a.key_uuid="r-"+_nbtutorDeps.uuid.v4(),r._createObject(n,e),r.connectors.push({from:a.key_uuid,to:n.uuid}));var o=s.getObjectById(e,a.val_id);t.options.inline_vals&&"primitive"==o.catagory||(a.val_uuid="r-"+_nbtutorDeps.uuid.v4(),r._createObject(o,e),r.connectors.push({from:a.val_uuid,to:o.uuid}))});var a=this._createHeapDiv(t);a.append("div").attr("class","nbtutor-var-type").text(t.type);var n=a.append("table").attr("class","nbtutor-seq-key-value"),o=t.values.length-1;t.options.ellipsis&&"..."!=t.values[o]&&t.values.push("...");var i=n.selectAll("tr").data(t.values).enter().append("tr"),u=i.append("td").attr("class","nbtutor-anchor-from"),c=i.append("td").attr("class","nbtutor-anchor-from");u.append("div").each(function(r){if(t.options.ellipsis&&"..."===r)_nbtutorDeps.d3.select(this).text("...");else{var a=s.getObjectById(e,r.key_id);t.options.inline_keys&&"primitive"===a.catagory?_nbtutorDeps.d3.select(this).text(a.value):_nbtutorDeps.d3.select(this).attr("id",function(t){return t.key_uuid})}}),c.append("div").each(function(r){if(t.options.ellipsis&&"..."===r)_nbtutorDeps.d3.select(this).text("...");else{var a=s.getObjectById(e,r.val_id);t.options.inline_vals&&"primitive"===a.catagory?_nbtutorDeps.d3.select(this).text(a.value):_nbtutorDeps.d3.select(this).attr("id",function(t){return t.val_uuid})}}),u.on("mouseover",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!0),r._setHover(t.key_uuid,!0)}),u.on("mouseout",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!1),r._setHover(t.key_uuid,!1)}),c.on("mouseover",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!0),r._setHover(t.val_uuid,!0)}),c.on("mouseout",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!1),r._setHover(t.val_uuid,!1)})}},{key:"_createObject",value:function(t,e){if(!(this.objects_rendered.indexOf(t.uuid)>=0))switch(this.objects_rendered.push(t.uuid),t.catagory){case"primitive":this._createPrimitive(t);break;case"sequence":this._createSequence(t,e);break;case"array":this._createArray(t,e);break;case"key-value":this._createKeyValue(t,e);break;default:this._createPrimitive({uuid:t.uuid,type:t.type,options:t.options,value:"OBJECT"})}}},{key:"create",value:function(t){this.destroy(),this.d3Root.append("div").attr("class","nbtutor-stack"),this.d3Root.append("div").attr("class","nbtutor-heap");var e=this.trace_history.stack_history,r=this.trace_history.heap_history,s=e.getStackFrames(t),a=this.d3Root.select(".nbtutor-stack").selectAll("div").data(s,function(t){return t.uuid}).enter().append("div").attr("class","nbtutor-frame");a.append("table").attr("id",function(t){return t.uuid}).append("thead").append("tr").append("th").attr("colspan",2).text(function(t){return t.name}),a.select("table").append("tbody"),a.select("table").append("tfoot");var n=a.select("tbody").selectAll("tr").data(function(t){return t.vars.map(function(e){return{object:e,options:t.options}})},function(t){return t.object.name}).enter().append("tr"),o=this;n.append("td").attr("class","nbtutor-var-name").text(function(t){return t.object.name}),n.append("td").attr("class","nbtutor-anchor-from").append("div").attr("id",function(t){return t.object.uuid}).each(function(e){var s=r.getObjectById(t,e.object.id);e.options.inline&&"primitive"===s.catagory?_nbtutorDeps.d3.select(this).text(s.value):(o._createObject(s,t),o.connectors.push({from:e.object.uuid,to:s.uuid}))}),this._connectObjects();var i=this.d3Root.select(".nbtutor-stack").selectAll("table");i.classed("nbtutor-active",!1),_nbtutorDeps.d3.select(i[0].pop()).classed("nbtutor-active",!0),n.on("mouseover",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!0),o._setHover(t.object.uuid,!0)}),n.on("mouseout",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!1),o._setHover(t.object.uuid,!1)}),(0,_nbtutorDeps.$)(window).resize(function(){o.jsplumb.repaintEverything()})}},{key:"destroy",value:function(){this.jsplumb.empty(this.d3Root[0]),this.d3Root.selectAll("div").remove(),this.connectors=[],this.objects_rendered=[]}}]),t}();

},{"nbtutor-deps":"nbtutor-deps"}],11:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.TimelineUI=void 0;var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_nbtutorDeps=require("nbtutor-deps"),TimelineUI=exports.TimelineUI=function(){function t(e,n){_classCallCheck(this,t),this.stack_timeline=e,this.d3Root=n}return _createClass(t,[{key:"create",value:function(){this.destroy();for(var t=["Names"],e=0;e<this.stack_timeline.tracestep;e++)t.push(e);var n=this.d3Root.append("div").attr("class","nbtutor-timeline-canvas"),r=n.selectAll("div").data(this.stack_timeline.stack_frames,function(t){return t.uuid}).enter().append("div").attr("class","nbtutor-timeline").append("table").attr("id",function(t){return t.uuid}),a=r.append("thead"),o=r.append("tbody");r.append("tfoot");a.append("tr").append("th").attr("colspan",this.stack_timeline.tracestep+1).text(function(t){return t.name}),a.append("tr").selectAll("th").data(t).enter().append("th").text(function(t){return t});var s=o.selectAll("tr").data(function(t){return t.vars},function(t){return t.name}).enter().append("tr");s.selectAll("td").data(function(t){return[t.name].concat(t.values)}).enter().append("td").attr("class",function(t,e){return e>0?"nbtutor-var-value":"nbtutor-var-name"}).text(function(t){return t}),s.on("mouseover",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!0)}),s.on("mouseout",function(t){_nbtutorDeps.d3.select(this).classed("nbtutor-hover",!1)})}},{key:"destroy",value:function(){this.d3Root.selectAll("div").remove()}}]),t}();

},{"nbtutor-deps":"nbtutor-deps"}]},{},[8])(8)
});