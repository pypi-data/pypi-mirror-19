

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick Start Guide &mdash; TrotterSuzuki 1.6.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="TrotterSuzuki 1.6.1 documentation" href="index.html"/>
        <link rel="next" title="Examples" href="examples.html"/>
        <link rel="prev" title="Download and Installation" href="download.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> TrotterSuzuki
          

          
          </a>

          
            
            
              <div class="version">
                1.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="download.html">Download and Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simulation-set-up">Simulation Set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysis">Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#expectation-values">Expectation values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#norm-of-the-state">Norm of the state</a></li>
<li class="toctree-l3"><a class="reference internal" href="#particle-density-and-phase">Particle density and Phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#imprinting">Imprinting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-input-and-output">File Input and Output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Function Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">TrotterSuzuki</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Quick Start Guide</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-start-guide">
<h1>Quick Start Guide<a class="headerlink" href="#quick-start-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="simulation-set-up">
<h2>Simulation Set up<a class="headerlink" href="#simulation-set-up" title="Permalink to this headline">¶</a></h2>
<p>Start by importing the module:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">trottersuzuki</span> <span class="k">as</span> <span class="nn">ts</span>
</pre></div>
</div>
<p>To set up the simulation of a quantum system, we need only a few lines of code.
First of all, we create the lattice over which the physical system is
defined. All information about the discretized space is collected in a
single object. Say we want a squared lattice of 300x300 nodes, with a
physical area of 20x20, then we have to specify these in the constructor of the <code class="docutils literal"><span class="pre">Lattice</span></code> class:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">Lattice2D</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)</span>
</pre></div>
</div>
<p>The object <code class="docutils literal"><span class="pre">grid</span></code> defines the geometry of the system and it
will be used throughout the simulations. Note that the origin of the lattice is at its centre and the lattice points are scaled to the physical locations. The actual transformation is exposed to the user via the function <cite>center_coordinates</cite>.</p>
<p>The physics of the problem is described by the Hamiltonian. A single
object is going to store all the information regarding the Hamiltonian.
The module is able to deal with two physical models: Gross-Pitaevskii
equation of a single or two-component wave function, namely (in units
<span class="math">\(\hbar=1\)</span>):</p>
<div class="math">
\[i \frac{\partial}{\partial t} \psi(t) = H \psi(t)\]</div>
<p>being</p>
<div class="math">
\[H = \frac{1}{2m}(P_x^2 + P_y^2) + V(x,y) + g|\psi(x,y)|^2 + \omega L_z\]</div>
<p>and <span class="math">\(\psi(t) = \psi_t(x,y)\)</span> for the single component wave
function, or</p>
<div class="math">
\[\begin{split}H = \begin{bmatrix} H_1 &amp;  \frac{\Omega}{2} \\ \frac{\Omega}{2} &amp; H_2 \end{bmatrix}\end{split}\]</div>
<p>where</p>
<div class="math">
\[ \begin{align}\begin{aligned}H_1 = \frac{1}{2m_1}(P_x^2 + P_y^2) + V_1(x,y) + g_1|\psi(x,y)_1|^2 + g_{12}|\psi(x,y)_2|^2 + \omega L_z\\H_2 = \frac{1}{2m_2}(P_x^2 + P_y^2) + V_2(x,y) + g_2|\psi(x,y)_2|^2 + g_{12}|\psi(x,y)_1|^2 + \omega L_z\end{aligned}\end{align} \]</div>
<p>and
<span class="math">\(\psi(t) = \begin{bmatrix} \psi_1(t) \\ \psi_2(t) \end{bmatrix}\)</span>,
for the two component wave function.</p>
<p>First we define the object for the external potential <span class="math">\(V(x,y)\)</span>. A
general external potential function can be defined by a Python
function, for instance, the harmonic potential can be defined as follows:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">harmonic_potential</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we create the external potential object using the <code class="docutils literal"><span class="pre">Potential</span></code>
class and then we initialize it with the function above:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">potential</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">Potential</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>  <span class="c1"># Create the potential object</span>
<span class="n">potential</span><span class="o">.</span><span class="n">init_potential</span><span class="p">(</span><span class="n">harmonic_potential</span><span class="p">)</span>  <span class="c1"># Initialize it using a python function</span>
</pre></div>
</div>
<p>Note that the module provides a quick way to define the harmonic
potential, as it is fequently used:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">omegax</span> <span class="o">=</span> <span class="n">omegay</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">harmonicpotential</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">HarmonicPotential</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">omegax</span><span class="p">,</span> <span class="n">omegay</span><span class="p">)</span>
</pre></div>
</div>
<p>We are ready to create the <code class="docutils literal"><span class="pre">Hamiltonian</span></code> object. For the sake of simplicity, let us create the Hamiltonian of the harmonic oscillator:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">particle_mass</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c1"># Mass of the particle</span>
<span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">Hamiltonian</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">particle_mass</span><span class="p">)</span>  <span class="c1"># Create the Hamiltonian object</span>
</pre></div>
</div>
<p>The quantum state is created by the <code class="docutils literal"><span class="pre">State</span></code> class; it resembles the way the potential is defined. Here we create the ground state of the
harmonic oscillator:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># Import the module numpy for the exponential and sqrt functions</span>

<span class="k">def</span> <span class="nf">state_wave_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>  <span class="c1"># Wave function</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>  <span class="c1"># Create the quantum state</span>
<span class="n">state</span><span class="o">.</span><span class="n">init_state</span><span class="p">(</span><span class="n">state_wave_function</span><span class="p">)</span>  <span class="c1"># Initialize the state</span>
</pre></div>
</div>
<p>The module provides several predefined quantum states as well. In this
case, we could have used the <code class="docutils literal"><span class="pre">GaussianState</span></code> class:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">omega</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">gaussianstate</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">GaussianState</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>  <span class="c1"># Create a quantum state whose wave function is Gaussian-like</span>
</pre></div>
</div>
<p>We are left with the creation of the last object: the <code class="docutils literal"><span class="pre">Solver</span></code> class gathers all the objects we defined so far and it is used to perform the evolution and analyze the expectation values:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">delta_t</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">3</span>  <span class="c1"># Physical time of a single iteration</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">Solver</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">delta_t</span><span class="p">)</span>  <span class="c1"># Creating the solver object</span>
</pre></div>
</div>
<p>Finally we can perform both real-time and imaginary-time evolution using
the method <code class="docutils literal"><span class="pre">evolve</span></code>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Number of iterations to be performed</span>
<span class="n">solver</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">iterations</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># Perform imaginary-time evolution</span>
<span class="n">solver</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">iterations</span><span class="p">)</span>  <span class="c1"># Perform real-time evolution</span>
</pre></div>
</div>
</div>
<div class="section" id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<p>The classes we have seen so far implement several members useful to
analyze the system (see the function reference section for a complete
list).</p>
<div class="section" id="expectation-values">
<h3>Expectation values<a class="headerlink" href="#expectation-values" title="Permalink to this headline">¶</a></h3>
<p>The solver class provides members for the energy calculations. For
instance, the total energy can be calculated using the
<code class="docutils literal"><span class="pre">get_total_energy</span></code> member. We expect it to be <span class="math">\(1\)</span>
(<span class="math">\(\hbar =1\)</span>), and indeed we get the right result up to a small
error which depends on the lattice approximation:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">tot_energy</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">get_total_energy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tot_energy</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.00146456951</span>
</pre></div>
</div>
<p>The expected values of the <span class="math">\(X\)</span>, <span class="math">\(Y\)</span>, <span class="math">\(P_x\)</span>,
<span class="math">\(P_y\)</span> operators are calculated using the members in the <code class="docutils literal"><span class="pre">State</span></code>
class</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">mean_x</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_mean_x</span><span class="p">()</span>  <span class="c1"># Get the expected value of X operator</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean_x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.39431975344e-14</span>
</pre></div>
</div>
</div>
<div class="section" id="norm-of-the-state">
<h3>Norm of the state<a class="headerlink" href="#norm-of-the-state" title="Permalink to this headline">¶</a></h3>
<p>The squared norm of the state can be calculated by means of both
<code class="docutils literal"><span class="pre">State</span></code> and <code class="docutils literal"><span class="pre">Solver</span></code> classes</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">snorm</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_squared_norm</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">snorm</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="particle-density-and-phase">
<h3>Particle density and Phase<a class="headerlink" href="#particle-density-and-phase" title="Permalink to this headline">¶</a></h3>
<p>Very often one is interested in the phase and particle density of the
state. Two members of <code class="docutils literal"><span class="pre">State</span></code> class provide these features</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">density</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_particle_density</span><span class="p">()</span>  <span class="c1"># Return a numpy matrix of the particle density</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_phase</span><span class="p">()</span>  <span class="c1"># Return a numpy matrix of the phase</span>
</pre></div>
</div>
</div>
<div class="section" id="imprinting">
<h3>Imprinting<a class="headerlink" href="#imprinting" title="Permalink to this headline">¶</a></h3>
<p>The member <code class="docutils literal"><span class="pre">imprint</span></code>, in the <code class="docutils literal"><span class="pre">State</span></code> class, applies the following transformation to the state:</p>
<div class="math">
\[\psi(x,y) \rightarrow \psi'(x,y) = f(x,y)  \psi(x,y)\]</div>
<p>being <span class="math">\(f(x,y)\)</span> a general complex-valued function. This comes in
handy when we want to imprint, for instance, vortices or solitons:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">vortex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>  <span class="c1"># Function defining a vortex</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">y</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span>

<span class="n">state</span><span class="o">.</span><span class="n">imprint</span><span class="p">(</span><span class="n">vortex</span><span class="p">)</span>  <span class="c1"># Imprint the vortex on the state</span>
</pre></div>
</div>
</div>
<div class="section" id="file-input-and-output">
<h3>File Input and Output<a class="headerlink" href="#file-input-and-output" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">write_to_files</span></code> and <code class="docutils literal"><span class="pre">loadtxt</span></code> members, in <code class="docutils literal"><span class="pre">State</span></code> class, provide
a simple way to handle file I/O. The former writes the wave function
arranged as a complex matrix, in a plain text; the latter loads the wave
function from a file to the <code class="docutils literal"><span class="pre">state</span></code> object. The following code
provides an example:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="n">state</span><span class="o">.</span><span class="n">write_to_file</span><span class="p">(</span><span class="s2">&quot;file_name&quot;</span><span class="p">)</span>  <span class="c1"># Write the wave function to a file</span>
<span class="n">state2</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>  <span class="c1"># Create a new state</span>
<span class="n">state2</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;file_name&quot;</span><span class="p">)</span>  <span class="c1"># Load the wave function from the file</span>
</pre></div>
</div>
<p>For a complete list of methods see the function reference.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="download.html" class="btn btn-neutral" title="Download and Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2016, Peter Wittek, Luca Calderaro.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.6.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>